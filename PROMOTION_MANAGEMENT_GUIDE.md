# HÆ°á»›ng dáº«n Quáº£n lÃ½ MÃ£ Æ¯u Ä‘Ã£i (Promotions Management)

## ğŸ“‹ TÃ­nh nÄƒng

Há»‡ thá»‘ng quáº£n lÃ½ mÃ£ Æ°u Ä‘Ã£i cho phÃ©p báº¡n:

-   âœ… Táº¡o mÃ£ Æ°u Ä‘Ã£i má»›i
-   âœ… Chá»‰nh sá»­a mÃ£ Æ°u Ä‘Ã£i hiá»‡n táº¡i
-   âœ… XÃ³a mÃ£ Æ°u Ä‘Ã£i
-   âœ… KÃ­ch hoáº¡t/vÃ´ hiá»‡u hÃ³a mÃ£ Æ°u Ä‘Ã£i
-   âœ… Theo dÃµi thá»i gian Ã¡p dá»¥ng mÃ£ Æ°u Ä‘Ã£i
-   âœ… Há»— trá»£ 2 loáº¡i giáº£m giÃ¡: Pháº§n trÄƒm (%) vÃ  Cá»‘ Ä‘á»‹nh (â‚«)

## ğŸš€ CÃ¡ch sá»­ dá»¥ng

### 1. Truy cáº­p trang quáº£n lÃ½

-   ÄÄƒng nháº­p vÃ o Admin Panel
-   Chá»n **"MÃ£ Æ°u Ä‘Ã£i"** tá»« menu sidebar bÃªn trÃ¡i

### 2. Táº¡o mÃ£ Æ°u Ä‘Ã£i má»›i

1. Nháº¥p nÃºt **"ThÃªm mÃ£ Æ°u Ä‘Ã£i"** (nÃºt xanh)
2. Äiá»n thÃ´ng tin:

    - **MÃ£ Æ°u Ä‘Ã£i**: VD `SUMMER20`, `SALE50` (chá»¯ hoa, khÃ´ng khoáº£ng tráº¯ng)
    - **MÃ´ táº£**: MÃ´ táº£ chi tiáº¿t vá» mÃ£ Æ°u Ä‘Ã£i (tÃ¹y chá»n)
    - **Loáº¡i giáº£m giÃ¡**:
        - Pháº§n trÄƒm (%): Giáº£m % so vá»›i giÃ¡ trá»‹ Ä‘Æ¡n hÃ ng
        - Cá»‘ Ä‘á»‹nh (â‚«): Giáº£m sá»‘ tiá»n cá»‘ Ä‘á»‹nh
    - **GiÃ¡ trá»‹**: Nháº­p giÃ¡ trá»‹ giáº£m giÃ¡ (VD: 20 cho 20%, hoáº·c 100000 cho 100.000â‚«)
    - **NgÃ y báº¯t Ä‘áº§u**: NgÃ y báº¯t Ä‘áº§u Ã¡p dá»¥ng mÃ£
    - **NgÃ y káº¿t thÃºc**: NgÃ y háº¿t háº¡n mÃ£
    - **KÃ­ch hoáº¡t**: Ticked Ä‘á»ƒ báº­t mÃ£ Æ°u Ä‘Ã£i

3. Nháº¥n **"Táº¡o mÃ£ Æ°u Ä‘Ã£i"** Ä‘á»ƒ lÆ°u

### 3. Chá»‰nh sá»­a mÃ£ Æ°u Ä‘Ã£i

1. Tá»« danh sÃ¡ch, nháº¥n nÃºt **Chá»‰nh sá»­a** (biá»ƒu tÆ°á»£ng bÃºt chÃ¬)
2. Chá»‰nh sá»­a thÃ´ng tin cáº§n thiáº¿t
3. Nháº¥n **"Cáº­p nháº­t"** Ä‘á»ƒ lÆ°u

### 4. XÃ³a mÃ£ Æ°u Ä‘Ã£i

1. Tá»« danh sÃ¡ch, nháº¥n nÃºt **XÃ³a** (biá»ƒu tÆ°á»£ng thÃ¹ng rÃ¡c)
2. XÃ¡c nháº­n láº¡i khi Ä‘Æ°á»£c yÃªu cáº§u

### 5. KÃ­ch hoáº¡t/VÃ´ hiá»‡u hÃ³a mÃ£

-   Chá»‰nh sá»­a mÃ£ Æ°u Ä‘Ã£i vÃ  tick/bá» tick vÃ o checkbox "KÃ­ch hoáº¡t mÃ£ Æ°u Ä‘Ã£i"
-   Hoáº·c ngoÃ i má»¥c **Tráº¡ng thÃ¡i** trong danh sÃ¡ch hiá»ƒn thá»‹ `Hoáº¡t Ä‘á»™ng` hoáº·c `KhÃ´ng hoáº¡t Ä‘á»™ng`

## ğŸ“Š VÃ­ dá»¥

### VÃ­ dá»¥ 1: MÃ£ giáº£m 20%

```
MÃ£ Æ°u Ä‘Ã£i: SUMMER20
Loáº¡i giáº£m giÃ¡: Pháº§n trÄƒm (%)
GiÃ¡ trá»‹: 20
â†’ KhÃ¡ch hÃ ng nháº­p mÃ£ nÃ y, giáº£m 20% giÃ¡ Ä‘Æ¡n hÃ ng
```

### VÃ­ dá»¥ 2: MÃ£ giáº£m 100.000â‚«

```
MÃ£ Æ°u Ä‘Ã£i: SALE100K
Loáº¡i giáº£m giÃ¡: Cá»‘ Ä‘á»‹nh (â‚«)
GiÃ¡ trá»‹: 100000
â†’ KhÃ¡ch hÃ ng nháº­p mÃ£ nÃ y, giáº£m 100.000â‚« (cá»‘ Ä‘á»‹nh)
```

## ğŸ”— Quy trÃ¬nh hoáº¡t Ä‘á»™ng

### Luá»“ng dá»¯ liá»‡u:

1. **Admin táº¡o mÃ£ Æ°u Ä‘Ã£i** â†’ LÆ°u vÃ o database (báº£ng `promotions`)
2. **KhÃ¡ch hÃ ng nháº­p mÃ£** â†’ Kiá»ƒm tra API `/kiem-tra-ma-giam-gia`
3. **Server xÃ¡c thá»±c**:
    - MÃ£ cÃ³ tá»“n táº¡i?
    - MÃ£ cÃ³ hoáº¡t Ä‘á»™ng?
    - CÃ³ náº±m trong thá»i gian Ã¡p dá»¥ng?
4. **TÃ­nh toÃ¡n giáº£m giÃ¡** â†’ Tráº£ vá» cho frontend
5. **LÆ°u vÃ o Ä‘Æ¡n hÃ ng** â†’ TrÆ°á»ng `promotion_code` vÃ  `discount_amount` trong báº£ng `orders`

## ğŸ“± Giao diá»‡n ngÆ°á»i dÃ¹ng (Customer)

KhÃ¡ch hÃ ng sáº½ tháº¥y:

1. Ã” nháº­p mÃ£ Æ°u Ä‘Ã£i á»Ÿ trang **Giá» hÃ ng** (cart/index.blade.php)
2. Ã” nháº­p mÃ£ Æ°u Ä‘Ã£i á»Ÿ trang **Thanh toÃ¡n** (checkout/index.blade.php)
3. Khi nháº­p mÃ£:
    - âœ… ThÃ nh cÃ´ng: Hiá»ƒn thá»‹ má»©c giáº£m giÃ¡, tá»•ng tiá»n Ä‘Æ°á»£c cáº­p nháº­t
    - âŒ Tháº¥t báº¡i: Hiá»ƒn thá»‹ lá»—i (mÃ£ khÃ´ng há»£p lá»‡, háº¿t háº¡n, etc.)

## ğŸ” Äiá»u kiá»‡n Ã¡p dá»¥ng (cÃ³ thá»ƒ má»Ÿ rá»™ng)

Hiá»‡n táº¡i há»‡ thá»‘ng kiá»ƒm tra:

-   âœ… MÃ£ tá»“n táº¡i trong database
-   âœ… MÃ£ Ä‘Æ°á»£c kÃ­ch hoáº¡t (`is_active = true`)
-   âœ… NgÃ y hiá»‡n táº¡i náº±m trong khoáº£ng tá»« `start_date` Ä‘áº¿n `end_date`

CÃ³ thá»ƒ thÃªm Ä‘iá»u kiá»‡n khÃ¡c:

-   ÄÆ¡n hÃ ng tá»‘i thiá»ƒu (VD: tá»‘i thiá»ƒu 500.000â‚«)
-   Sáº£n pháº©m cá»¥ thá»ƒ
-   Danh má»¥c cá»¥ thá»ƒ
-   Sá»‘ láº§n sá»­ dá»¥ng tá»‘i Ä‘a

## ğŸ“ CÆ¡ sá»Ÿ dá»¯ liá»‡u

### Báº£ng: `promotions`

```
id              - ID (khÃ³a chÃ­nh)
title           - TiÃªu Ä‘á»
description     - MÃ´ táº£
code            - MÃ£ Æ°u Ä‘Ã£i (duy nháº¥t)
discount_value  - GiÃ¡ trá»‹ giáº£m giÃ¡
discount_type   - Loáº¡i: 'percentage' hoáº·c 'fixed'
start_date      - NgÃ y báº¯t Ä‘áº§u
end_date        - NgÃ y káº¿t thÃºc
is_active       - Tráº¡ng thÃ¡i hoáº¡t Ä‘á»™ng
created_at      - Thá»i Ä‘iá»ƒm táº¡o
updated_at      - Thá»i Ä‘iá»ƒm cáº­p nháº­t
```

### Báº£ng: `orders` (cÃ¡c trÆ°á»ng má»›i)

```
promotion_code  - MÃ£ Æ°u Ä‘Ã£i Ä‘Æ°á»£c Ã¡p dá»¥ng
discount_amount - Sá»‘ tiá»n giáº£m giÃ¡ (tÃ­nh toÃ¡n Ä‘Æ°á»£c)
```

## ğŸ› ï¸ Ká»¹ thuáº­t

### Routes Ä‘Æ°á»£c thÃªm:

```php
Route::resource('promotions', PromotionController::class);
```

### API Endpoint (cho checkout):

```
POST /kiem-tra-ma-giam-gia
Request: { code: "SUMMER20" }
Response: { success: true, discount: 100000, ... }
```

### Controller chÃ­nh:

-   `App\Http\Controllers\Admin\PromotionController`

### Views:

-   `resources/views/admin/promotions/index.blade.php` - Danh sÃ¡ch
-   `resources/views/admin/promotions/create.blade.php` - Táº¡o má»›i
-   `resources/views/admin/promotions/edit.blade.php` - Chá»‰nh sá»­a

## âš ï¸ LÆ°u Ã½ quan trá»ng

1. **MÃ£ pháº£i duy nháº¥t**: KhÃ´ng thá»ƒ cÃ³ 2 mÃ£ Æ°u Ä‘Ã£i giá»‘ng nhau
2. **MÃ£ viáº¿t hoa**: Há»‡ thá»‘ng tá»± Ä‘á»™ng chuyá»ƒn mÃ£ nháº­p vÃ o thÃ nh chá»¯ hoa
3. **Kiá»ƒm tra ngÃ y**: Äáº£m báº£o `start_date â‰¤ end_date`
4. **KÃ­ch hoáº¡t**: Chá»‰ mÃ£ Ä‘Æ°á»£c kÃ­ch hoáº¡t má»›i Ä‘Æ°á»£c sá»­ dá»¥ng
5. **Loáº¡i giáº£m giÃ¡**:
    - Pháº§n trÄƒm: Tá»‘i Ä‘a 100%
    - Cá»‘ Ä‘á»‹nh: CÃ³ thá»ƒ báº¥t ká»³ sá»‘ tiá»n nÃ o

## ğŸ¯ Tiáº¿p theo cÃ³ thá»ƒ lÃ m

-   [ ] ThÃªm Ä‘áº¿m sá»‘ láº§n sá»­ dá»¥ng cá»§a má»—i mÃ£
-   [ ] ThÃªm giá»›i háº¡n sá»‘ láº§n sá»­ dá»¥ng (`usage_limit`)
-   [ ] ThÃªm Ä‘iá»u kiá»‡n: ÄÆ¡n hÃ ng tá»‘i thiá»ƒu
-   [ ] ThÃªm cÃ¡c sáº£n pháº©m/danh má»¥c Ã¡p dá»¥ng cá»¥ thá»ƒ
-   [ ] ThÃªm bÃ¡o cÃ¡o: MÃ£ Ä‘Æ°á»£c sá»­ dá»¥ng bao nhiÃªu láº§n?
-   [ ] ThÃªm nháº­p/xuáº¥t dá»¯ liá»‡u mÃ£ Æ°u Ä‘Ã£i (Excel)
-   [ ] ThÃªm QR code cho mÃ£ Æ°u Ä‘Ã£i

---

**PhiÃªn báº£n**: 1.0  
**NgÃ y cáº­p nháº­t**: ThÃ¡ng 12, 2025
